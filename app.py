from flask import Flask, render_template, request
import hashlib
from os import mkdir

class App:
    def __init__(self):
        self.app = Flask(__name__)
    
    def routes(self):
        @self.app.route("/")
        def index():
            return render_template('index.html')
        
        @self.app.route('/result', methods = ['GET', 'POST'])
        def upload_file():
            if request.method == 'POST':
                # Get the file
                f = request.files['file']

                # Get the MD5 of it
                h = hashlib.md5()
                h.update(f.read())
                
                # Save the file
                mkdir("env/" + h.hexdigest())
                f.save("env/" + h.hexdigest() + "/" + f.filename)
                return 'file uploaded successfully'
            else: return "Invalid upload request."

if __name__ == '__main__':
    instance = App()
    instance.routes()
    instance.app.run()